1. 关键代码
```c
#define PWM_PERIOD 2000  // 2ms周期对应的计数值
#define DUTY_CYCLE_30_PERCENT (PWM_PERIOD * 30 / 100)  // 30%占空比  

int pwm_value = 0;

HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1); 
  HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);  

  __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, DUTY_CYCLE_30_PERCENT);
  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {      	  
//	pwm_value += direction;
//	// 限制PWM值在合理范围内
//	if (pwm_value >= PWM_PERIOD) {
//	  pwm_value = PWM_PERIOD;  // 达到上限，保持最大值
//	  direction = -1;          // 改变方向为递减
//	} else if (pwm_value <= 0) {
//	  pwm_value = 0;           // 达到下限，保持最小值
//	  direction = 1;           // 改变方向为递增
//	}
	for(pwm_value = 0; pwm_value < PWM_PERIOD; pwm_value++) {
		__HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, pwm_value);
		HAL_Delay(1);
	}	  
	for(pwm_value = PWM_PERIOD; pwm_value > 0; pwm_value--) {
		__HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, pwm_value);
		HAL_Delay(1);
	}		
    // 更新通道2的占空比
    __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, pwm_value);
    HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin);
    // 控制呼吸灯变化速度
    HAL_Delay(1);  // 调整这个延时可以改变呼吸速度
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */
  }
  /* USER CODE END 3 */
}
```
2. 现象
其中一个通道实现周期为2ms、占空比为30的PWM波形
另一个通道实现周期为2ms、占空比随时间递增的LED呼吸灯

***
2025/11/8/19:04 cjh